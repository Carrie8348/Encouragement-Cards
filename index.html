<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <title>Encouragement Card Draw</title>
  <style>
    body {
      font-family: sans-serif;
      background-color: #ccbdf2;
      text-align: center;
      padding: 2rem 1rem;
    }

    h1 {
      margin-bottom: 1rem;
      color: #47034E;
    }

    .rainbow-title {
      font-size: 2.4rem;
      font-weight: bold;
      background: white;
      display: inline-block;
      padding: 0.8rem 1.2rem;
      border-radius: 1.2rem;
      box-shadow: 0 4px 12px rgba(0,0,0,0.08);
      margin-bottom: 1rem;

      /* ✅ 修改部分 ↓ */
      text-align: left;
      margin-left: 1rem; /* 靠左贴近一点 */
    }

    .rainbow-title .line {
      white-space: nowrap;
      text-align: left;
    }


    .container {
      max-width: 800px;
      margin: 0 auto;
    }

    .draw-area {
      position: relative;
      height: 250px;
      margin-bottom: 20px;
    }

    .card-box {
      position: absolute;
      bottom: 0;
      left: 50%;
      transform: translateX(-50%);
      width: 300px;
      height: auto;
      z-index: 1;
    }

    .floating-card {
      position: absolute;
      bottom: 180px;
      left: 50%;
      transform: translateX(-50%) translateY(0);
      width: auto;
      height: auto;
      max-width: 90%;
      max-height: 400px;
      display: none;
      z-index: 2;
      opacity: 1;
    }

    .animate {
      animation: floatCard 1s ease forwards;
    }

    @keyframes floatCard {
      0% {
        transform: translateX(-50%) translateY(200px) rotate(0deg);
        opacity: 0;
      }
      50% {
        transform: translateX(-50%) translateY(30px) rotate(180deg);
        opacity: 1;
      }
      100% {
        transform: translateX(-50%) translateY(0px) rotate(360deg);
        opacity: 1;
      }
    }

    .card-glow {
      position: absolute;
      bottom: 150px;
      left: 50%;
      transform: translateX(-50%);
      width: 360px;
      height: 360px;
      background: radial-gradient(circle, rgba(255, 215, 0, 0.4) 0%, rgba(255, 255, 255, 0) 70%);
      border-radius: 50%;
      opacity: 0;
      z-index: 1;
      pointer-events: none;
      filter: blur(12px); /* ✨模糊发光效果 */
      transition: opacity 0.3s ease;
    }

  .card-glow.active {
      animation: glowPulse 1s ease forwards;
    }

@keyframes glowPulse {
    0% {
      transform: translateX(-50%) scale(0.6);
      opacity: 0;
    }
    50% {
      transform: translateX(-50%) scale(1.3);
      opacity: 0.9;
    }
    100% {
      transform: translateX(-50%) scale(1);
      opacity: 0;
    }
  }

  .particle {
    position: absolute;
    width: 16px;
    height: 16px;
    background: radial-gradient(circle, gold 0%, orange 70%, transparent 100%);
    border-radius: 50%;
    opacity: 1;
    animation: fly 1.2s ease-out forwards;
    filter: drop-shadow(0 0 4px rgba(255, 255, 100, 0.8));
}

  .particle {
    position: absolute;
    width: 20px;
    height: 20px;
    background-image: url('data:image/svg+xml;utf8,<svg fill="gold" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><polygon points="12,2 15,9 22,9 17,14 19,21 12,17 5,21 7,14 2,9 9,9"/></svg>');
    background-size: contain;
    background-repeat: no-repeat;
    background-position: center;
    opacity: 1;
    animation: fly 1.4s ease-out forwards;
    filter: drop-shadow(0 0 6px rgba(255, 223, 0, 0.8));
}


@keyframes fly {
    0% {
      transform: translate(0, 0) scale(1);
      opacity: 1;
    }
    100% {
      transform: translate(var(--x), var(--y)) scale(0.3);
      opacity: 0;
    }
  }


    .btn {
      margin: 10px auto;
      padding: 12px 24px;
      font-size: 16px;
      border-radius: 8px;
      border: none;
      background-color: #7E3285;
      color: white;
      cursor: pointer;
      display: inline-block;
    }

    .btn:hover {
      background-color: #5D0565;
    }

    .history {
      margin-top: 40px;
    }

    .history h2 {
      margin-bottom: 10px;
      color: #47034E;
    }

    .history-list {
      display: flex;
      justify-content: center;
      flex-wrap: wrap;
      gap: 10px;
    }

    .history img {
      width: 100px;
      height: auto;
      object-fit: contain;
      border-radius: 6px;

    }

    .more-link {
      margin-top: 10px;
      font-size: 14px;
    }

    .more-link a {
      color: #9f5ea5;
      text-decoration: none;
    }

    @media (max-width: 600px) {
      .rainbow-title {
        font-size: 6vw;
    }
}
   

  </style>
</head>
<body>

  <h1 class="rainbow-title">
    <div class="line">
      <span style="color:#F94144">E</span>
      <span style="color:#F3722C">n</span>
      <span style="color:#F8961E">c</span>
      <span style="color:#F9844A">o</span>
      <span style="color:#F9C74F">u</span>
      <span style="color:#90BE6D">r</span>
      <span style="color:#43AA8B">a</span>
      <span style="color:#577590">g</span>
      <span style="color:#4D908E">e</span>
      <span style="color:#577590">m</span>
      <span style="color:#F9C74F">e</span>
      <span style="color:#F8961E">n</span>
      <span style="color:#F3722C">t</span>
    </div>
    <div class="line">
      <span style="color:#F94144">C</span>
      <span style="color:#F3722C">a</span>
      <span style="color:#F9C74F">r</span>
      <span style="color:#90BE6D">d</span>
    </div>
  </h1>
  

  <div class="container">
    <div class="draw-area">
      <div class="card-glow"></div><!-- ✨发光层，放在卡片后面 -->
      <div class="particles"></div> <!-- ✨星星粒子层 -->
      <img id="cardImage" class="floating-card" src="" alt="Card" />
      <img class="card-box" src="cards/card-box.png" alt="Card Box" />
    </div>

    <button class="btn" onclick="drawCard()">Draw a Card</button>

    <div class="history">
      <h2>Recent Draws</h2>
      <div id="historyList" class="history-list"></div>
      <div class="more-link">
        <a href="history.html">View All Draws →</a>
      </div>
    </div>
  </div>

  <script>
    function drawCard() {
      const totalCards = 102;
      const randomNum = Math.floor(Math.random() * totalCards) + 1;
      const imageUrl = `cards/card-${randomNum}.png`;

      const card = document.getElementById("cardImage");
      card.src = imageUrl;
      card.style.display = "block";
      card.classList.remove("animate");
      void card.offsetWidth;
      card.classList.add("animate");

      // ✅ 播放音效
      const audio = document.getElementById("drawSound");
      if (audio) {
        audio.currentTime = 0; // 重置时间
        audio.play();
      }

      // ✅ 光圈动画
      const glow = document.querySelector(".card-glow");
      glow.classList.remove("active");
      void glow.offsetWidth; // 触发重绘
      glow.classList.add("active");

      // ✨ 生成星星粒子
      const particlesContainer = document.querySelector('.particles');
          const colors = ['#FFD700', '#FF69B4', '#87CEFA', '#ADFF2F', '#FFA500', '#EE82EE'];

          for (let i = 0; i < 12; i++) {
      const particle = document.createElement('div');
      particle.className = 'particle';

      const angle = Math.random() * 2 * Math.PI;
      const distance = 80 + Math.random() * 80;
      const x = Math.cos(angle) * distance + 'px';
      const y = Math.sin(angle) * distance + 'px';

      particle.style.setProperty('--x', x);
      particle.style.setProperty('--y', y);

      particlesContainer.appendChild(particle);

      setTimeout(() => particle.remove(), 1400);
    }

      // ✅ ⬇️ 让盒子区域拉高显示动画
      document.querySelector('.draw-area').style.height = "550px";

      const now = new Date();
      const timestamp = now.toISOString();

      let history = JSON.parse(localStorage.getItem("cardHistory")) || [];
      history.push({ num: randomNum, time: timestamp });
      localStorage.setItem("cardHistory", JSON.stringify(history));

      renderHistory();
    }

    function renderHistory() {
      const history = JSON.parse(localStorage.getItem("cardHistory")) || [];
      const historyList = document.getElementById("historyList");
      historyList.innerHTML = "";

      const recent = history.slice(-5).reverse();
      recent.forEach((entry) => {
        if (entry && entry.num) {
          const img = document.createElement("img");
          img.src = `cards/card-${entry.num}.png`;
          img.alt = `Card ${entry.num}`;
          historyList.appendChild(img);
        }
      });
    }

    window.onload = renderHistory;
  </script>

  <audio id="drawSound" src="sounds/ding.mp3" preload="auto"></audio>


</body>
</html>
